import{_ as i,c as a,a2 as n,o as h}from"./chunks/framework.CKGreiRV.js";const r=JSON.parse('{"title":"sokol_gfx.h","description":"","frontmatter":{},"headers":[],"relativePath":"resource/sokol/gfx.md","filePath":"resource/sokol/gfx.md","lastUpdated":1732720247000}'),p={name:"resource/sokol/gfx.md"};function l(t,s,k,e,E,d){return h(),a("div",null,s[0]||(s[0]=[n(`<h1 id="sokol-gfx-h" tabindex="-1">sokol_gfx.h <a class="header-anchor" href="#sokol-gfx-h" aria-label="Permalink to &quot;sokol_gfx.h&quot;">​</a></h1><p>シンプルな 3D API ラッパー</p><p>プロジェクトURL: <a href="https://github.com/floooh/sokol" target="_blank" rel="noreferrer">https://github.com/floooh/sokol</a></p><p>コード例: <a href="https://github.com/floooh/sokol-samples" target="_blank" rel="noreferrer">https://github.com/floooh/sokol-samples</a></p><p>このファイルをCまたはC++ファイルにインクルードして実装を作成する前に、</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_IMPL</span></span></code></pre></div><p>または</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_GFX_IMPL</span></span></code></pre></div><p>を定義してください。</p><p>同じ場所で、レンダリングバックエンドを選択するために、以下のいずれかを定義します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_GLCORE33</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_GLES2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_GLES3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_D3D11</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_METAL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_WGPU</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_DUMMY_BACKEND</span></span></code></pre></div><p>例えば、GL 3.3 Core Profileの場合、次のようになります。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_IMPL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SOKOL_GLCORE33</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;sokol_gfx.h&quot;</span></span></code></pre></div><p>ダミーバックエンドは、プラットフォーム固有のバックエンドコードを空のスタブ関数で置き換えます。これは、コマンドラインで実行する必要があるテストを書くときに便利です。</p><p>オプションで、以下の定義を独自の実装で提供します。</p><ul><li>SOKOL_ASSERT(c) - 独自のアサートマクロ (デフォルト: assert(c))</li><li>SOKOL_UNREACHABLE() - 到達不可能なコードのためのガードマクロ (デフォルト: assert(false))</li><li>SOKOL_GFX_API_DECL - 公開関数宣言のプレフィックス (デフォルト: extern)</li><li>SOKOL_API_DECL - SOKOL_GFX_API_DECLと同じです。</li><li>SOKOL_API_IMPL - public 関数実装の接頭辞（デフォルト：-）。</li><li>SOKOL_TRACE_HOOKS - トレースフックコールバックを有効にする (以下、TRACE HOOKS で検索)</li><li>SOKOL_EXTERNAL_GL_LOADER - 独自のGLローダーを使用していることを示します。この場合、sokol_gfx.hは、いかなるプラットフォームGLヘッダーも含まず、統合されたWin32 GLローダーを無効化します。</li></ul><p>sokol_gfx.hがDLLとしてコンパイルされる場合、宣言または実装を含む前に以下を定義してください。</p><p><code>SOKOL_DLL</code></p><p>Windowsでは、SOKOL_DLLは、必要に応じて、SOKOL_GFX_API_DECLを__declspec(dllexport) または __declspec(dllimport) として定義します。</p><p>非推奨の構造体や関数を使わずにコンパイルしたい場合は、定義します。</p><p><code>SOKOL_NO_DEPRECATED</code></p><p>オプションで以下を定義すると、リリースモードでもデバッグチェックとバリデーションを強制的に行うことができます。</p><p><code>SOKOL_DEBUG</code></p><p>デフォルトでは、_DEBUG が定義されている場合に定義されます。</p><h2 id="sokol-gfx-does-not" tabindex="-1">sokol_gfx DOES NOT: <a class="header-anchor" href="#sokol-gfx-does-not" aria-label="Permalink to &quot;sokol_gfx DOES NOT:&quot;">​</a></h2><ul><li><p>ウィンドウまたは3D-APIコンテキスト/デバイスを作成する。sokol_gfxが初期化される前にこれを行い、必要な情報（3Dデバイスポインタなど）をsokol_gfxの初期化コールに渡す必要があります。</p></li><li><p>レンダリングされたフレームを表示します。これが正確に行われる方法は、通常、ウィンドウと3D-APIコンテキスト/デバイスの作成方法に依存します。</p></li><li><p>統一されたシェーダー言語を提供する代わりに、3D-API固有のシェーダーソースコードまたはシェーダーバイトコードを提供する必要があります（「公式」オフラインシェーダークロスコンパイラーについては、こちらを参照してください）。</p></li><li><p><a href="https://github.com/floooh/sokol-tools/blob/master/docs/sokol-shdc.md" target="_blank" rel="noreferrer">https://github.com/floooh/sokol-tools/blob/master/docs/sokol-shdc.md</a>)</p></li></ul><h2 id="ステップバイステップ" tabindex="-1">ステップバイステップ <a class="header-anchor" href="#ステップバイステップ" aria-label="Permalink to &quot;ステップバイステップ&quot;">​</a></h2><p>を呼び出して sokol_gfx を初期化し、ウィンドウと 3D-API コンテキスト/デバイスを作成した後、これを呼び出します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>リソースオブジェクト（少なくともバッファ、シェーダ、パイプライン、オプションでイメージとパス）を作成します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_buffer_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_image </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_image_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_shader_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pipeline </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pipeline_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pass </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pass_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>デフォルトフレームバッファへのレンダリングを開始します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_begin_default_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pass_action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>...または、その代わりに。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_begin_default_passf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pass_action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>...フレームバッファの幅と高さをfloat値として受け取ります。</p><p>または、オフスクリーンフレームバッファへのレンダリングを開始します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_begin_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pass_action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>で次の描画呼び出しのためのパイプラインの状態を設定します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_apply_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>sg_bindings 構造体に、次の描画呼び出しのためのリソースバインディング（1〜N個の頂点バッファ、0個または1個のインデックスバッファ、頂点シェーダおよびフラグメントシェーダステージでそれぞれテクスチャとして使用する0〜N個のイメージオブジェクト）を詰め、以下を呼び出します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_apply_bindings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_bindings</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> bindings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>でリソースバインディングを更新します。</p><p>オプションでシェーダーユニフォームデータを更新する。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_apply_uniforms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader_stage </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">stage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> ub_index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>sg_apply_uniforms() に渡されるユニフォームデータの期待されるメモリレイアウトについて学ぶために、セクション &#39;UNIFORM DATA LAYOUT&#39; を読んでみてください。</p><p>で描画呼び出しをキックオフします。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_draw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> base_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> num_elements</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> num_instances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>sg_draw() 関数は、プリミティブをレンダリングするすべての異なる方法(インデックス付きレンダリングと非インデックス付きレンダリング、インスタンス付きレンダリングと非インスタンス付きレンダリング)を1つの呼び出しで統一しています。インデックス付きレンダリングの場合、base_element と num_element は、現在結合されているインデックスバッファのインデックスを指定します。インデックスなしレンダリングの場合、base_element と num_elements は、現在結合されている頂点バッファの頂点を指定します。インスタンスレンダリングを行うには、レンダリングパイプラインがインスタンス用に設定され（下記の sg_pipeline_desc 参照）、インスタンス毎のデータを含む別の頂点バッファがバインドされ、num_instancesパラメータが&gt; 1 でなければなりません。</p><p>現在のレンダリングパスを終了します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_end_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>を呼び出し、現在のフレームを終了させる。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_commit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>でsokol_gfxをシャットダウンしてください。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_shutdown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>sg_shutdown() の前にリソースを破棄する必要がある場合、呼び出す。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_destroy_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_destroy_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_destroy_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_destroy_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_destroy_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>を呼び出して、新しいビューポート矩形を設定します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_apply_viewport</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> origin_top_left</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>...または、ビューポートの矩形をfloat値で指定したい場合。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_apply_viewportf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> origin_top_left</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>をクリックすると、新しいシザーレートを設定することができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_apply_scissor_rect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> origin_top_left</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>...またはfloat値で。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_apply_scissor_rectf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> y</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> origin_top_left</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>sg_apply_viewport() と sg_apply_scissor_rect() の両方はレンダリングパスの内部で呼び出されなければなりません。</p><blockquote><p>sg_begin_default_pass() と sg_begin_pass() はフレームバッファ全体をカバーするためにビューポートとシザーの矩形をリセットすることに注意してください。</p></blockquote><p>を呼び出して、バッファと画像リソースの内容を更新(上書き)してください。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_update_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_update_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_image_data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>更新するバッファとイメージは、SG_USAGE_DYNAMIC または SG_USAGE_STREAM で作成されている必要があります。</p><p>sg_update_*() 関数を使用するとき、バッファとイメージリソースに対してフレームあたり1回のみ更新が許可されます。その根拠は、CPU が GPU が現在使用しているデータを上書きしたり、CPU が GPU を待たせたりしないようにするための簡単な対策です。</p><p>バッファと画像の更新は、レンダリング操作がバッファまたは画像内の有効な （更新された）データだけを参照する限り、部分的であってもかまいません。</p><p>バッファリソースにデータのチャンクを追加するには、以下を呼び出します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_append_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_range</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>sg_update_buffer() との違いは、 sg_append_buffer() がフレームごとに複数回呼び出されて、新しいデータを少しずつバッファに追加できることで、オプションで前に書き込んだデータを参照する描画の呼び出しとインターリーブされています。</p><p>sg_append_buffer() は書き込まれたデータの開始へのバイトオフセットを返します。このオフセットは sg_bindings.vertex_buffer_offsets[n] または sg_bindings.index_buffer_offset に代入することが可能です。</p><p>コード例</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (...) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num_bytes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_append_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buf, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_range) { .ptr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data, .size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_bytes });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bindings.vertex_buffer_offsets[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sg_apply_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pip);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sg_apply_bindings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bindings);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sg_apply_uniforms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(...);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sg_draw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(...);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>sg_append_buffer() で使用するバッファは、SG_USAGE_DYNAMIC または SG_USAGE_STREAM で作成されている必要があります。</p><p>アプリケーションが、バッファに収まるより多くのデータをバッファに追加した場合、バッファは、フレームの残りのために &quot;オーバーフロー&quot; 状態になります。</p><p>オーバーフローしたバッファをレンダリングしようとする描画コールはすべて、サイレントドロップされます（デバッグモードでは、これは検証エラーにもなります）。</p><p>バッファがオーバーフロー状態にあるかどうかを手動で確認することもできます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_query_buffer_overflow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>バッファにデータを追加する前に、オーバーフローが発生するかどうかを手動で確認するには、以下のように呼び出します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_query_buffer_will_overflow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><blockquote><p>注: 基礎となる 3D-API の制限のため、追加されたデータのチャンクは、宛先バッファで 4 バイトにアラインされます。これは、sg_append_buffer()の呼び出しのインデックスの数が奇数であるとき、16ビットインデックスを含むインデックスバッファにギャップがあることを意味します。sg_append_buffer() の各呼び出しが1つの描画呼び出しに関連している場合、これは問題ではありませんが、1つのインデックス付き描画呼び出しがインデックスのいくつかの追加チャンクにまたがる場合は問題になるでしょう。</p></blockquote><p>を呼び出して、オプション機能、制限、pixelformatのサポートを実行時にチェックします。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_features </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_features</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_limits </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_limits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pixelformat_info </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_pixelformat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pixel_format </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>を直接呼び出す必要がある場合、その基礎となる3D-APIを呼び出す必要があります。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_reset_state_cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>...再びsokol_gfxの関数を呼び出す前に</p><p>sg_query_desc() を呼び出すことによって、 sg_setup() に渡されたオリジナルの sg_desc 構造体を検査することができます。これは、ゼロ初期化された値の代わりに、デフォルト値がパッチされた sg_desc 構造体を返します。</p><p>を介して、様々な内部リソースの属性を検査することができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer_info </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_buffer_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_image_info </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_image_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_info </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_shader_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pipeline_info </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_pipeline_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pass_info </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_pass_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>...返される情報構造体は sokol_gfx.h の内部と密接に結びついており、他の公開 API 関数や構造体よりも頻繁に変更される可能性があることに注意してください。</p><p>sokol_gfx.hがどのバックエンド用にコンパイルされたか、あるいはGLES3バックエンドがGLES2にフォールバックしなければならなかったかをランタイムに尋ねることができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_backend </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>という関数で、デフォルトのリソース作成パラメータを問い合わせることができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer_desc </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_buffer_defaults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_buffer_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_image_desc </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_image_defaults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_image_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_desc </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_shader_defaults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_shader_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pipeline_desc </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_pipeline_defaults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pipeline_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pass_desc </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_pass_defaults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pass_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>これらの関数は、デフォルト値のためにゼロ初期化された項目を含むことができる desc 構造体へのポインタを取ります。これらのゼロ初期化された値は、返された desc 構造体の具体的な値に置き換えられます。</p><h2 id="on-initialization" tabindex="-1">ON INITIALIZATION: <a class="header-anchor" href="#on-initialization" aria-label="Permalink to &quot;ON INITIALIZATION:&quot;">​</a></h2><p>sg_setup() を呼び出すとき、初期化オプションを含む sg_desc 構造体へのポインタを提供しなければなりません。これらのオプションは sokol-gfx に2つのタイプの情報を提供します。</p><p>(1) 様々な内部リソースを割り当てるために必要な上限と下限</p><p>データ構造</p><ul><li>同時にアライブできる各タイプのリソースの最大数、これは内部プールを割り当てるために使用されます。</li><li>フレームごとに更新できる均一なデータの最大サイズ、均一な更新ごとの最悪のケースのアライメントを含む（この最悪のケースのアライメントは256バイトです）</li><li>フレームごとのすべての動的なリソースの更新（sg_update_buffer、sg_append_buffer、sg_update_image）の最大サイズ。</li><li>テクスチャサンプラーキャッシュの最大エントリ数（同時にいくつのユニークなテクスチャサンプラーが存在できるのか）</li></ul><p>これらの制限値のすべてが、すべてのバックエンドで使用されるわけではありません。 を提供するのはよい習慣です。</p><p>(2) 3D-APIの「コンテキスト情報」（「バインディング」とも呼ばれることがある）。</p><p>sokol_gfx.h は、プレゼンテーション層に密接に関連する 3D API オブジェクトを作成または初期化しません (これは、「レンダリングデバイス」、スワップチェーン、およびスワップチェーンに依存する任意のオブジェクトを含みます)。これらの API オブジェクト（または、フレーム間でオブジェクトが変更される可能性がある場合、それらを取得するコールバック関数）は、sg_desc 構造体の中に入れ子された sg_context_desc 構造体で提供されなければなりません。sokol_gfx.h が sokol_app.h と共に使用される場合、 sokol_app.h によって提供されるコンテキスト情報で満たされた sg_context_desc 構造体を得るための便利な関数を提供する sokol_glue.h ヘッダーを見てみてください。</p><p>より詳細な情報は、以下の sg_desc 構造体のドキュメントブロックを参照してください。</p><h2 id="uniform-data-layout" tabindex="-1">UNIFORM DATA LAYOUT: <a class="header-anchor" href="#uniform-data-layout" aria-label="Permalink to &quot;UNIFORM DATA LAYOUT:&quot;">​</a></h2><blockquote><p>注：シェーダーコンパイラツール sokol-shdc を使用する場合、以下の詳細について心配する必要はありません。</p></blockquote><p>sg_apply_uniforms() 関数に渡されるデータは、GPU シェーダが正しいオフセットでユニフォームブロックアイテムを見つけるように、特定のレイアウトルールに従わなければなりません。</p><p>D3D11 と Metal バックエンドでは、sokol-gfx はユニフォームブロックのサイズにのみ関 心があり、内部レイアウトには関心がありません。データは一回の操作で均一/定数バッファにコピーされ、GPU側のレイアウトと一致するようにCPU側のレイアウトをアレンジするのはあなた次第です。これは、D3D11 と Metal バックエンドでは、ユニフォーム変数タイプの「クロスプラッ トフォーム」サブセットに制限されないということでもあります。</p><p>D3D11、Metal <em>または</em> WebGPUバックエンドのいずれか1つだけを使用する場合は、ここで読むのをやめてもかまいません。</p><p>GLバックエンドでは、ユニフォームブロックの内部レイアウトが重要で、ユニフォーム変数の型は少数に制限されます。これは、glUniformXXX()呼び出しでGPUにアップロードするために、sokol-gfxがユニフォームブロックメンバーの位置を特定できる必要があるためです。</p><p>ユニフォームブロックのレイアウトを sokol-gfx に記述するために、 sg_make_shader() の呼び出しに、以下の情報を sg_shader_desc 構造体で渡す必要があります。</p><ul><li>使用されるパッキングルールに関するヒント (SG_UNIFORMLAYOUT_NATIVE または SG_UNIFORMLAYOUT_STD140 のいずれか)</li><li>CPU 側に表示される正しい順序での均一ブロックメンバーの型のリスト</li></ul><p>例えば、GLSL シェーダが以下のユニフォーム宣言を持つ場合。</p><div class="language-glsl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">glsl</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uniform</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> mat4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mvp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uniform</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> vec2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset0;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uniform</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> vec2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset1;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uniform</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> vec2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset2;</span></span></code></pre></div><p>...そして、CPU側には、同様のC構造体があります。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> mvp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> offset0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> offset1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    float</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> offset2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">params_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>...sg_shader_descのユニフォームブロックの記述は、次のようなものでなければなりません。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_desc desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .vs.uniform_blocks[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">params_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .layout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_UNIFORMLAYOUT_NATIVE,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // this is the default and can be omitted</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .uniforms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // order must be the same as in &#39;params_t&#39;:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;mvp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, .type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_UNIFORMTYPE_MAT4 },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;offset0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, .type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_UNIFORMTYPE_VEC2 },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;offset1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, .type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_UNIFORMTYPE_VEC2 },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;offset2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, .type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_UNIFORMTYPE_VEC2 },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>この情報により、sokol-gfxはユニフォームブロック構造内のデータアイテムの正しいオフセットを計算することができます。</p><p>SG_UNIFORMLAYOUT_NATIVEパッキングルールは、GLバックエンドのみが使用される場合はうまく機能しますが、適切なD3D11/Metal/GLでは、次のセクションで説明するstd140レイアウトのサブセットを使用しなければなりません。</p><h2 id="クロスバックエンド共通の統一データレイアウト" tabindex="-1">クロスバックエンド共通の統一データレイアウト <a class="header-anchor" href="#クロスバックエンド共通の統一データレイアウト" aria-label="Permalink to &quot;クロスバックエンド共通の統一データレイアウト&quot;">​</a></h2><p>クロスプラットフォーム/クロス3Dバックエンドのコードでは、CPU側のブロックレイアウトがすべてのsokol-gfxバックエンドで同じ統一されたものを使用できることが重要です。これを実現するためには、std140レイアウトの共通のサブセットを使用しなければなりません。</p><ul><li>sg_shader_desc の均一ブロックレイアウトヒントは、明示的に SG_UNIFORMLAYOUT_STD140 に設定する必要があります。</li><li>以下のGLSLユニフォームタイプのみが使用可能です（関連するsokol-gfx enumもあります）。 <ul><li>float =&gt; SG_UNIFORMTYPE_FLOAT</li><li>vec2 =&gt; SG_UNIFORMTYPE_FLOAT2</li><li>vec3 =&gt; SG_UNIFORMTYPE_FLOAT3</li><li>vec4 =&gt; SG_UNIFORMTYPE_FLOAT4</li><li>int =&gt; SG_UNIFORMTYPE_INT</li><li>ivec2 =&gt; SG_UNIFORMTYPE_INT2</li><li>ivec3 =&gt; SG_UNIFORMTYPE_INT3</li><li>ivec4 =&gt; SG_UNIFORMTYPE_INT4</li><li>mat4 =&gt; SG_UNIFORMTYPE_MAT4</li></ul></li><li>これらの型のアライメントは、以下の通り（バイト単位）でなければならない。 <ul><li>float =&gt; 4</li><li>vec2 =&gt; 8</li><li>vec3 =&gt; 16</li><li>vec4 =&gt; 16</li><li>int =&gt; 4</li><li>ivec2 =&gt; 8</li><li>ivec3 =&gt; 16</li><li>ivec4 =&gt; 16</li><li>mat4 =&gt; 16</li></ul></li><li>配列は、vec4, int4, mat4 の型にのみ許されます。</li></ul><blockquote><p>HLSL の cbuffer のレイアウト規則は std140 のレイアウト規則と若干異なるので，HLSL コードの cbuffer 宣言は std140 と互換性があるように調整しなければならないことに注意してください．</p></blockquote><p>一般的な均一ブロックレイアウトの問題を解決する最も簡単な方法は、sokol-shdc シェーダクロスコンパイラツールを使用することです!</p><h2 id="バックエンドに特化したトピック" tabindex="-1">バックエンドに特化したトピック <a class="header-anchor" href="#バックエンドに特化したトピック" aria-label="Permalink to &quot;バックエンドに特化したトピック&quot;">​</a></h2><p>GLバックエンドは、ユニフォームブロックの内部構造、テクスチャサンプラー名と-typeについて知る必要があります。ユニフォームレイアウトの詳細は、上記のUNIFORM DATA LAYOUTセクションで説明されています。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// uniform block structure and texture image definition in sg_shader_desc:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_desc desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // uniform block description (size and internal structure)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .vs.uniform_blocks[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // one texture on the fragment-shader-stage, GLES2/WebGL needs name and image type</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .fs.images[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, .type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SG_IMAGETYPE_ARRAY }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>MetalとD3D11のバックエンドは、ユニフォームブロックのサイズだけを知っていればよく、その内部メンバー構造を知っている必要はありません。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_desc desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .vs.uniform_blocks[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">params_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .fs.images[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_IMAGETYPE_ARRAY,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>シェーダオブジェクトを作成するとき、GLES2/WebGLはバーテックスシェーダで使用されるバーテックス属性名を知る必要があります。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_desc desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .attrs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;position&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;color1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>シェーダ作成時に提供された頂点属性名は、後に sg_create_pipeline() で頂点レイアウトと頂点シェーダ入力を一致させるために使用されます。</p><p>D3D11 では、代わりにセマンティック名とセマンティックインデックスをシェーダ記述構造体で提供する必要があります（詳細は D3D11_INPUT_ELEMENT_DESC の D3D11 のドキュメントを参照してください）。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_desc desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .attrs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .sem_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POSITION&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, .sem_index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .sem_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;COLOR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, .sem_index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>提供された意味情報は、後に sg_create_pipeline() で頂点レイアウトとバーテックスシェーダ入力を一致させるために使用されます。</p><p>D3D11 で、（バイトコードではなく）HLSL ソースコードをシェーダ作成に渡すとき、オプションで頂点ステージにシェーダモデルターゲットを定義することができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader_Desc desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .vs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .d3d11_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vs_5_0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .fs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .d3d11_target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ps_5_0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>デフォルトのターゲットは &quot;ps_4_0 &quot;と &quot;fs_4_0 &quot;です。これらのターゲット名は、ソースからシェーダをコンパイルするときのみ使用されることに注意してください。バイトコードからシェーダを作成する場合、これらは無視されます。</p><p>Metal、GL 3.3、または GLES3/WebGL2 では、頂点属性はそのスロットインデックスでバインドできるため、属性名や意味名を提供する必要はありません（これは Metal では必須、GL では任意です）。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pipeline_desc desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .layout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .attrs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .format</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SG_VERTEXFORMAT_FLOAT3 },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { .format</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SG_VERTEXFORMAT_FLOAT4 }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h2 id="working-with-contexts" tabindex="-1">WORKING WITH CONTEXTS <a class="header-anchor" href="#working-with-contexts" aria-label="Permalink to &quot;WORKING WITH CONTEXTS&quot;">​</a></h2><p>sokol-gfx は、異なるレンダリングコンテキストを切り替えて、リソースオブジェクトを コンテキストに関連付けることができます。これは、複数のウィンドウにレンダリングするGLアプリケーションを作成するのに便利です。</p><p>レンダリングコンテキストは、コンテキストがアクティブである間に作成されたすべてのリソースを追跡します。コンテキストが破棄されると、「コンテキストに属している」すべてのリソースも破棄されます。</p><p>デフォルトのコンテキストは sg_setup() で暗黙のうちに作成、有効化され、sg_shutdown() で破棄されます。したがって、複数のコンテキストを使用しない典型的なアプリケーションでは、何も変更されず、コンテキスト関数を呼び出す必要はありません。</p><p>コンテキストを扱うために、3つの関数が追加されました。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_context </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_setup_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span></code></pre></div><p>GL コンテキストが作成され、アクティブになった後に一度だけ呼び出される必要があります。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_activate_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>これは、異なるGLコンテキストをアクティブにした後に呼び出す必要があります。3D-API固有の動作とは別に、sg_activate_context()の呼び出しは、内部的にsg_reset_state_cache()を呼び出すことになります。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_discard_context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_context </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>これは GL コンテキストが破壊される直前に呼ばれなければならず，コンテキストに関連するすべてのリソース（コンテキストがアクティブだった間に作成されたもの）を破壊します． sg_discard_context(sg_context ctx) が呼ばれた時点で GL コンテキストはアクティブになっていなければなりません．</p><p>また、リソース（バッファ、イメージ、シェーダ、パイプライン）は、リソースが作成されたときにアクティブであったのと同じGLコンテキストがアクティブである間のみ使用または破棄されなければならないことに注意してください（例外はGLのリソース共有で、そのようなリソースは別のコンテキストがアクティブであっても使用できますが、作成時にアクティブだった同じコンテキストで破棄しなければならない）。</p><p>より詳しい情報は、multiwindow-glfwのサンプルをご覧ください。</p><p><a href="https://github.com/floooh/sokol-samples/blob/master/glfw/multiwindow-glfw.c" target="_blank" rel="noreferrer">https://github.com/floooh/sokol-samples/blob/master/glfw/multiwindow-glfw.c</a></p><h2 id="trace-hooks" tabindex="-1">TRACE HOOKS: <a class="header-anchor" href="#trace-hooks" aria-label="Permalink to &quot;TRACE HOOKS:&quot;">​</a></h2><p>sokol_gfx.h は、オプションとして、各パブリック API 関数に対して &quot;trace hook&quot; コールバックをインストールすることができます。パブリックAPI関数が呼び出され、その関数にトレースフックコールバックがインストールされている場合、その関数のパラメータと結果でコールバックが呼び出されます。これは、デバッグツールやプロファイリングツール、あるいはリソースの生成と破棄を追跡するような場合に便利である。</p><p>トレースフック機能を使うには</p><p>実装をインクルードする前に SOKOL_TRACE_HOOKS を定義してください。</p><p>コールバック関数のポインタを持つ sg_trace_hooks 構造体を設定します (興味のない関数のポインタはすべてゼロ初期化したままにしておきます)。オプションで sg_trace_hooks 構造体の user_data メンバを設定します。</p><p>sg_install_trace_hooks() を呼び出してトレースフックをインストールします。この関数の戻り値は、以前に設定したトレースフックを含む、別の sg_trace_hooks 構造体です。この構造体を保持し、適切な連鎖のために、あなた自身のトレースコールバックからこれらの以前の関数のポインタを呼び出す必要があります。</p><p>トレースフックがどのように使用されるかの例として、 imgui/sokol_gfx_imgui.h ヘッダを見てください。これは sokol_gfx.h のリアルタイムデバッグ UI を Dear ImGui 上に実装しています。</p><h2 id="ポータブルパック頂点フォーマットに関するメモ" tabindex="-1">ポータブルパック頂点フォーマットに関するメモ: <a class="header-anchor" href="#ポータブルパック頂点フォーマットに関するメモ" aria-label="Permalink to &quot;ポータブルパック頂点フォーマットに関するメモ:&quot;">​</a></h2><p>UBYTE4、SHORT2 などの packed vertex フォーマットを使用する場合、すべてのバックエンドで動作させる必要があるため、2 つの点を考慮する必要があります。</p><p>D3D11 は頂点フェッチ時に <em>normalized</em> 頂点フォーマットを浮動小数点にのみ変換でき、 normalized フォーマットは最後に &#39;N&#39; があり、範囲 -1.0 ～ +1.0 (signed フォーマット) または 0.0 ～ 1.0 (unsigned フォー マット) に &quot;normalized&quot; されます。</p><ul><li>SG_VERTEXFORMAT_BYTE4N</li><li>SG_VERTEXFORMAT_UBYTE4N</li><li>SG_VERTEXFORMAT_SHORT2N</li><li>SG_VERTEXFORMAT_USHORT2N</li><li>SG_VERTEXFORMAT_SHORT4N</li><li>SG_VERTEXFORMAT_USHORT4N</li></ul><p>D3D11 は <em>non-normalized</em> 頂点フォーマットを浮動小数点バーテックスシェーダ入力 に変換しません。</p><ul><li><p>SG_VERTEXFORMAT_BYTE4,</p></li><li><p>SG_VERTEXFORMAT_UBYTE4</p></li><li><p>SG_VERTEXFORMAT_SHORT2</p></li><li><p>SG_VERTEXFORMAT_SHORT4</p></li><li><p>WebGL/GLES2 では、整数バーテックスシェーダ入力（int または ivecn）を使用できません。</p></li><li><p>SG_VERTEXFORMAT_UINT10_N2 は WebGL/GLES2 でサポートされていません。</p></li></ul><p>したがって、すべてのプラットフォームで動作する頂点入力レイアウトには、以下の頂点フォーマットのみを使用し、必要に応じて、127.0、255.0、32767.0 または 65535.0 を乗算して、頂点シェーダで正規化した頂点入力を「拡張」してください。</p><ul><li>SG_VERTEXFORMAT_FLOAT,</li><li>SG_VERTEXFORMAT_FLOAT2,</li><li>SG_VERTEXFORMAT_FLOAT3,</li><li>SG_VERTEXFORMAT_FLOAT4,</li><li>SG_VERTEXFORMAT_BYTE4N,</li><li>SG_VERTEXFORMAT_UBYTE4N,</li><li>SG_VERTEXFORMAT_SHORT2N,</li><li>SG_VERTEXFORMAT_USHORT2N</li><li>SG_VERTEXFORMAT_SHORT4N,</li><li>SG_VERTEXFORMAT_USHORT4N</li></ul><h2 id="メモリ割り当てオーバーライド" tabindex="-1">メモリ割り当てオーバーライド <a class="header-anchor" href="#メモリ割り当てオーバーライド" aria-label="Permalink to &quot;メモリ割り当てオーバーライド&quot;">​</a></h2><p>このように初期化時にメモリ割り当て関数をオーバーライドすることができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> my_alloc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> user_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> malloc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> my_free</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> ptr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> user_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    free</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ptr);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sg_setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_desc){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .allocator </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .alloc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> my_alloc,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .free </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> my_free,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .user_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span></code></pre></div><p>オーバーライドが提供されない場合、malloc と free が使用されます。</p><p>これは、sokol_gfx.h 自身が行うメモリ割り当ての呼び出しにのみ影響し、 OS ライブラリでの割り当ては影響しませんが。</p><h2 id="ログ関数オーバーライド" tabindex="-1">ログ関数オーバーライド <a class="header-anchor" href="#ログ関数オーバーライド" aria-label="Permalink to &quot;ログ関数オーバーライド&quot;">​</a></h2><p>このように初期化時にログ関数をオーバーライドすることができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> my_log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> user_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sg says: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\\s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sg_setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_desc){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .logger </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .log_cb </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> my_log,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .user_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span></code></pre></div><p>オーバーライドが提供されない場合、ほとんどのプラットフォームでputsが使用されます。Android では、代わりに __android_log_write が使用されます。</p><h2 id="コミットメントリスナー" tabindex="-1">コミットメントリスナー <a class="header-anchor" href="#コミットメントリスナー" aria-label="Permalink to &quot;コミットメントリスナー&quot;">​</a></h2><p>sg_commit() の内部から不特定の順序で呼び出されるコールバック関数を sokol-gfx にフックすることが可能です。これは主に、sokol_gfx.hの上に構築されるライブラリが、フレームの終了/開始について通知されるのに便利です。</p><p>コミットリスナーを追加するには、次のように呼び出します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> my_commit_listener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> user_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> success </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_add_commit_listener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((sg_commit_listener){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> my_commit_listener,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .user_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>コミットリスナーの内部配列が満杯の場合、あるいは同じコミットリスナーが既に追加されていた場合、この関数は false を返します。</p><p>この関数が true を返した場合、sg_commit() 内から my_commit_listener() がフレームごとに呼び出されます。</p><p>デフォルトでは、1024の異なるコミットリスナーを追加することができますが、この数はsg_setup()呼び出しで微調整することができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_desc){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .max_commit_listeners </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2048</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>sg_commit_listener の項目は、関数ポインタと user_data フィールドの両方が等しい場合、他の項目と等しくなります。</p><p>コミットリスナーを削除するには</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> success </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_remove_commit_listener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((sg_commit_listener){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> my_commit_listener,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .user_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>...ここで、.func と .user_data フィールドは以前の sg_add_commit_listener() の呼び出しと同じです。この関数はコミットリスナーの項目が見つかって削除された場合はtrueを、そうでない場合はfalseを返します。</p><h2 id="リソースの生成と破壊の詳細" tabindex="-1">リソースの生成と破壊の詳細 <a class="header-anchor" href="#リソースの生成と破壊の詳細" aria-label="Permalink to &quot;リソースの生成と破壊の詳細&quot;">​</a></h2><p>リソースオブジェクトを作成する「バニラ」な方法は、「make関数」を使用することです。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_buffer_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_image </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_image_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_shader_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pipeline </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pipeline_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pass </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_make_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pass_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>この場合、3つのケースのいずれかになります。</p><ol><li>返されたハンドルは無効である。これは、このリソースタイプのリソースプールに空きスロットがもうない場合に起こります。無効なハンドルは、例えば、INVALIDリソース状態に関連付けられます。</li></ol><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer buf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_make_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(...)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_buffer_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buf) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_RESOURCESTATE_INVALID) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // buffer pool is exhausted</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="2"><li>返されたハンドルは有効であるが、何らかの理由で基礎となるリソースの作成に失敗した。この結果、リソースオブジェクトは FAILED 状態になる。リソースの作成に失敗した理由は、リソースの種類によって異なります。詳細については、ログメッセージをご覧ください。失敗したリソースの状態は、次のようにして確認できます。</li></ol><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer buf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_make_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(...)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_buffer_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buf) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_RESOURCESTATE_FAILED) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // creating the resource has failed</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="3"><li>そして最後に、すべてがうまくいけば、返されたリソースはリソースステートVALIDになり、使用できるようになります。これは、次のようにして確認することができます。</li></ol><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer buf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_make_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(...)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_buffer_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buf) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_RESOURCESTATE_VALID) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // creating the resource has failed</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>「make関数」を呼び出すと、作成されたリソースは次のような状態を経ます。 の状態を経る。</p><ul><li>INITIAL: 新しいリソースに関連付けられたリソーススロットは現在フリーです (技術的には、まだリソースは存在せず、空のプールスロットがあるだけです)。</li><li>ALLOC: 新しいリソースのハンドルが割り当てられました。これは単にプールスロットが予約されたことを意味します。</li><li>VALID or FAILED: VALIDの場合、3D APIバックエンドリソースオブジェクトは正常に作成されました、それ以外の場合、リソースはFAILEDの状態になります。</li></ul><p>時には、最初にハンドルを取得し、後で基礎となるリソースを初期化することが理にかなっていることがあります。例えば、低速のデータソースから非同期にデータをロードする場合、ロードプロセスの早い段階でどのようなバッファやテクスチャが必要かが分かるかもしれませんが、実際にバッファやテクスチャの内容をロードするのは後のタイミングになります。</p><p>このような状況のために、sokol-gfxリソース・オブジェクトは2つのステップで作成することができます。alloc関数」の1つを使って、前もってハンドルを確保することができます。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_buffer </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_alloc_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_image </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_alloc_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_shader </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_alloc_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pipeline </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_alloc_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_pass </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_alloc_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>これは、ALLOC状態の基礎となるリソースオブジェクトを持つハンドルを返します。</p><div class="language-C vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">C</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sg_image img </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_alloc_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_query_image_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(img) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SG_RESOURCESTATE_ALLOC) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // allocating an image handle has succeeded, otherwise</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // the image pool is full</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>このような「不完全な」ハンドルは、ほとんどのsokol-gfxレンダリング関数で害なく使用することができ、sokol-gfxはVALID状態でないリソースを含むレンダリング操作を単にスキップします。</p><p>後で（例えば、テクスチャのロードが非同期で完了したら）、リソースの作成は「init関数」の一つを呼び出すことで完了します。これらの関数は、既存のリソースハンドルと「desc構造」を取ります。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_init_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_buffer_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_init_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_image_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_init_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_shader_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_init_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pipeline_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_init_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sg_pass_desc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> desc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>init関数はALLOC状態のリソースを想定しており、関数が戻った後、リソースはVALIDまたはFAILED状態のいずれかになる。alloc関数とそれに続くinit関数を呼び出すことは、make関数を単独で呼び出すことと完全に等価である。</p><p>破壊は、2段階のプロセスとして起こることもある。uninit関数」は、VALIDまたはFAILED状態からALLOC状態にリソースオブジェクトを戻す。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_uninit_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_uninit_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_uninit_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_uninit_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_uninit_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>VALIDまたはFAILEDの状態でないリソースで「uninit関数」を呼び出しても無駄である。</p><p>最終的にプールスロットを再利用のために解放するには、「dealloc関数」を呼び出します。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_dealloc_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_dealloc_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_dealloc_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_dealloc_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_dealloc_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>ALLOC状態でないリソースに対して「dealloc関数」を呼び出しても無駄ですが、警告のログメッセージは生成されます。</p><p>「uninit関数」と「dealloc関数」を連続して呼び出すことは、関連する「destroy関数」を呼び出すことと等価である。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_destroy_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_destroy_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_destroy_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_destroy_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sg_destroy_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>destroy 関数」はどのような状態のリソースに対しても呼び出すことができ、一般に正しい動作をします（例えば、リソースが ALLOC 状態の場合、destroy 関数は「dealloc 関数」と同等で、「uninit 部分」をスキップします）。</p><p>そして最後に、ALLOC状態のリソースを手動でFAILED状態にするために、「fail関数」を呼び出すことができる。</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_fail_buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_buffer </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_fail_image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_image </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">img</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_fail_shader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_shader </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_fail_pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pipeline </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sg_fail_pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sg_pass </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>これは、非同期リソース作成中にsokol-gfxの外部で何か問題が発生した場合（例えば、ファイルのロード操作に失敗したなど）に推奨されます。この場合、&#39;init関数&#39;の代わりに&#39;fail関数&#39;を呼び出す必要があります。</p><p>ALLOC状態でないリソースに対して「fail関数」を呼び出しても無駄ですが、警告のログメッセージは生成されます。</p><blockquote><p>注: 2段階のリソース作成は通常、バッファとイメージに対してのみ意味を持ちますが、シェーダ、パイプライン、パスに対しては意味を持ちません。特に、VALID状態でないシェーダーでパイプラインオブジェクトを作成しようとすると、検証レイヤーのエラーが発生します。また、検証レイヤーが無効になっている場合は、パイプラインオブジェクトがFAILED状態になります。イメージ無効のイメージオブジェクトでパスオブジェクトを作成しようとすると、同じことが起こります。</p></blockquote><h2 id="license" tabindex="-1">LICENSE <a class="header-anchor" href="#license" aria-label="Permalink to &quot;LICENSE&quot;">​</a></h2><p>zlib/libpng license</p><p>Copyright (c) 2018 Andre Weissflog</p><p>This software is provided &#39;as-is&#39;, without any express or implied warranty. In no event will the authors be held liable for any damages arising from the use of this software.</p><p>Permission is granted to anyone to use this software for any purpose, including commercial applications, and to alter it and redistribute it freely, subject to the following restrictions:</p><pre><code>1. The origin of this software must not be misrepresented; you must not
claim that you wrote the original software. If you use this software in a
product, an acknowledgment in the product documentation would be
appreciated but is not required.

2. Altered source versions must be plainly marked as such, and must not
be misrepresented as being the original software.

3. This notice may not be removed or altered from any source
distribution.
</code></pre>`,237)]))}const y=i(p,[["render",l]]);export{r as __pageData,y as default};
